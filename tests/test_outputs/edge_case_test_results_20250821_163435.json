[
  {
    "chunk_file": "test_chunk_random_1_20250821_162727.xlsx",
    "pattern_type": "random",
    "output_file": "test_output_test_chunk_random_1_20250821_162727_20250821_163038.xlsx",
    "processing_time": 77.44133186340332,
    "success": false,
    "stdout": "2025-08-21 16:30:39,470 - __main__ - INFO - Starting Contact Export workflow processing: tests\\test_datasets\\test_chunk_random_1_20250821_162727.xlsx\n2025-08-21 16:30:39,660 - __main__ - INFO - Loaded 100 records for processing\nProcessing Contact Export using unified core logic...\n2025-08-21 16:30:39,660 - core.data_processor - INFO - Processing contact export data: 100 records\n2025-08-21 16:30:39,660 - core.data_processor - INFO - Applying unified cleaning logic\n2025-08-21 16:30:39,660 - core.data_processor - WARNING - Missing required column: contact_name, added as null\n2025-08-21 16:30:39,661 - core.data_processor - WARNING - Missing required column: customer_name, added as null\n2025-08-21 16:30:39,661 - core.data_processor - WARNING - Missing required column: email, added as null\n2025-08-21 16:30:39,661 - core.data_processor - INFO - Cleaning and parsing names using unified LLM engine\n2025-08-21 16:30:39,661 - core.data_processor - INFO - Processing name batch 1: records 1-50\n2025-08-21 16:30:40,972 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:20,588 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:20,907 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:21,219 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:21,544 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:21,872 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:22,182 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:22,535 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:22,896 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:23,228 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:23,568 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:23,955 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:24,391 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:24,766 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:25,155 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:25,527 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:26,043 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:26,433 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:26,807 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:27,217 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:27,587 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:27,979 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:28,354 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:28,701 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:29,061 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:29,411 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:29,763 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:30,100 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:30,427 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:30,785 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:31,126 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:31,473 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:31,820 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:32,171 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:32,519 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:32,878 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:33,229 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:33,570 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:33,929 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:34,315 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:34,670 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:35,025 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:35,369 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:35,730 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:36,112 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:36,456 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:36,802 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:37,156 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:37,496 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:37,845 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:38,197 - core.data_processor - INFO - Processing name batch 2: records 51-100\n2025-08-21 16:31:38,197 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:38,549 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:38,885 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:39,230 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:39,570 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:39,935 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:40,297 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:40,650 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:40,988 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:41,338 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:41,747 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:42,106 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:42,481 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:42,841 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:43,173 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:43,506 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:43,864 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:44,289 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:44,646 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:44,982 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:45,474 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:45,855 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:46,349 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:46,679 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:47,054 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:47,376 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:47,714 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:48,068 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:48,440 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:48,774 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:49,119 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:49,460 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:49,815 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:50,169 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:50,553 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:50,873 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:51,199 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:51,561 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:51,907 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:52,255 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:52,600 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:52,957 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:53,307 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:53,667 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:54,074 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:54,446 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:54,775 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:55,128 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:55,468 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:55,818 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:56,168 - core.data_processor - INFO - Cleaning email addresses\n2025-08-21 16:31:56,170 - core.data_processor - INFO - Removing invalid records\n2025-08-21 16:31:56,190 - core.data_processor - INFO - Applying contact export-specific transformations\n2025-08-21 16:31:56,191 - core.data_processor - INFO - Contact export processing complete: 0 records\n2025-08-21 16:31:56,191 - __main__ - ERROR - Error in Contact Export workflow: 'First name'\nERROR: Error processing contact export data: 'First name'\nERROR: Contact workflow failed. Check logs for details.\n",
    "stderr": "--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n",
    "return_code": 1,
    "timestamp": "2025-08-21T16:31:56.338341",
    "analysis": {
      "chunk_file": "test_chunk_random_1_20250821_162727.xlsx",
      "pattern_type": "random",
      "success": false,
      "processing_time": 77.44133186340332,
      "issues_found": [
        "Workflow execution failed",
        "Unknown error occurred"
      ],
      "recommendations": [
        "Check input file path and permissions",
        "Verify Contact Export workflow configuration"
      ]
    }
  },
  {
    "chunk_file": "test_chunk_random_2_20250821_162727.xlsx",
    "pattern_type": "random",
    "output_file": "test_output_test_chunk_random_2_20250821_162727_20250821_163157.xlsx",
    "processing_time": 37.750088691711426,
    "success": false,
    "stdout": "2025-08-21 16:31:57,923 - __main__ - INFO - Starting Contact Export workflow processing: tests\\test_datasets\\test_chunk_random_2_20250821_162727.xlsx\n2025-08-21 16:31:58,114 - __main__ - INFO - Loaded 100 records for processing\nProcessing Contact Export using unified core logic...\n2025-08-21 16:31:58,115 - core.data_processor - INFO - Processing contact export data: 100 records\n2025-08-21 16:31:58,115 - core.data_processor - INFO - Applying unified cleaning logic\n2025-08-21 16:31:58,116 - core.data_processor - WARNING - Missing required column: contact_name, added as null\n2025-08-21 16:31:58,116 - core.data_processor - WARNING - Missing required column: customer_name, added as null\n2025-08-21 16:31:58,116 - core.data_processor - WARNING - Missing required column: email, added as null\n2025-08-21 16:31:58,116 - core.data_processor - INFO - Cleaning and parsing names using unified LLM engine\n2025-08-21 16:31:58,117 - core.data_processor - INFO - Processing name batch 1: records 1-50\n2025-08-21 16:31:58,745 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:59,202 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:59,554 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:31:59,894 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:00,240 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:00,590 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:00,912 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:01,265 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:01,606 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:01,926 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:02,261 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:02,677 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:03,009 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:03,385 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:03,754 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:04,150 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:04,487 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:04,835 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:05,195 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:05,567 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:05,911 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:06,268 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:06,646 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:07,036 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:07,394 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:07,732 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:08,066 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:08,421 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:08,782 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:09,113 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:09,471 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:09,832 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:10,180 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:10,543 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:10,913 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:11,244 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:11,591 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:11,945 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:12,287 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:12,705 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:13,049 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:13,398 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:13,745 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:14,163 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:14,520 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:14,868 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:15,266 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:15,706 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:16,090 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:16,483 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:16,954 - core.data_processor - INFO - Processing name batch 2: records 51-100\n2025-08-21 16:32:16,955 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:17,313 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:17,672 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:18,014 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:18,349 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:18,692 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:19,045 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:19,398 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:19,739 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:20,099 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:20,427 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:20,766 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:21,105 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:21,455 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:21,794 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:22,141 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:22,483 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:22,800 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:23,140 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:23,486 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:23,818 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:24,219 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:24,567 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:24,941 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:25,278 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:25,625 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:25,984 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:26,328 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:26,677 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:27,131 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:27,471 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:27,825 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:28,166 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:28,508 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:28,875 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:29,242 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:29,610 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:29,994 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:30,384 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:30,799 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:31,173 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:31,536 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:31,955 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:32,356 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:32,793 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:33,179 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:33,538 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:33,878 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:34,268 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:34,617 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:34,967 - core.data_processor - INFO - Cleaning email addresses\n2025-08-21 16:32:34,968 - core.data_processor - INFO - Removing invalid records\n2025-08-21 16:32:34,971 - core.data_processor - INFO - Applying contact export-specific transformations\n2025-08-21 16:32:34,972 - core.data_processor - INFO - Contact export processing complete: 0 records\n2025-08-21 16:32:34,973 - __main__ - ERROR - Error in Contact Export workflow: 'First name'\nERROR: Error processing contact export data: 'First name'\nERROR: Contact workflow failed. Check logs for details.\n",
    "stderr": "--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n",
    "return_code": 1,
    "timestamp": "2025-08-21T16:32:35.104171",
    "analysis": {
      "chunk_file": "test_chunk_random_2_20250821_162727.xlsx",
      "pattern_type": "random",
      "success": false,
      "processing_time": 37.750088691711426,
      "issues_found": [
        "Workflow execution failed",
        "Unknown error occurred"
      ],
      "recommendations": [
        "Check input file path and permissions",
        "Verify Contact Export workflow configuration"
      ]
    }
  },
  {
    "chunk_file": "test_chunk_random_3_20250821_162727.xlsx",
    "pattern_type": "random",
    "output_file": "test_output_test_chunk_random_3_20250821_162727_20250821_163236.xlsx",
    "processing_time": 38.54762053489685,
    "success": false,
    "stdout": "2025-08-21 16:32:36,690 - __main__ - INFO - Starting Contact Export workflow processing: tests\\test_datasets\\test_chunk_random_3_20250821_162727.xlsx\n2025-08-21 16:32:36,885 - __main__ - INFO - Loaded 100 records for processing\nProcessing Contact Export using unified core logic...\n2025-08-21 16:32:36,885 - core.data_processor - INFO - Processing contact export data: 100 records\n2025-08-21 16:32:36,885 - core.data_processor - INFO - Applying unified cleaning logic\n2025-08-21 16:32:36,886 - core.data_processor - WARNING - Missing required column: contact_name, added as null\n2025-08-21 16:32:36,886 - core.data_processor - WARNING - Missing required column: customer_name, added as null\n2025-08-21 16:32:36,886 - core.data_processor - WARNING - Missing required column: email, added as null\n2025-08-21 16:32:36,886 - core.data_processor - INFO - Cleaning and parsing names using unified LLM engine\n2025-08-21 16:32:36,887 - core.data_processor - INFO - Processing name batch 1: records 1-50\n2025-08-21 16:32:37,524 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:37,975 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:38,289 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:38,613 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:38,926 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:39,249 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:39,568 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:39,894 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:40,263 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:40,587 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:40,927 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:41,261 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:41,671 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:42,033 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:42,394 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:42,767 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:43,122 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:43,482 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:43,841 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:44,278 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:44,646 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:45,015 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:45,447 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:45,831 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:46,229 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:46,587 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:46,945 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:47,293 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:47,708 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:48,046 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:48,404 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:48,746 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:49,112 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:49,463 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:49,805 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:50,147 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:50,500 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:50,846 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:51,191 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:51,551 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:51,915 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:52,254 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:52,632 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:52,981 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:53,339 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:53,688 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:54,078 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:54,430 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:54,773 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:55,125 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:55,474 - core.data_processor - INFO - Processing name batch 2: records 51-100\n2025-08-21 16:32:55,474 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:55,815 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:56,158 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:56,525 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:56,893 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:57,240 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:57,628 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:57,984 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:58,341 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:58,688 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:59,045 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:59,399 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:32:59,751 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:00,139 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:00,516 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:00,866 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:01,224 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:01,601 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:01,944 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:02,273 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:02,620 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:02,960 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:03,374 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:03,766 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:04,202 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:04,577 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:04,961 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:05,318 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:05,676 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:06,082 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:06,536 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:07,053 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:07,399 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:07,863 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:08,229 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:08,576 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:09,033 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:09,420 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:09,768 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:10,169 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:10,523 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:10,892 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:11,261 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:11,724 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:12,178 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:12,620 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:12,981 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:13,375 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:13,741 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:14,145 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:14,510 - core.data_processor - INFO - Cleaning email addresses\n2025-08-21 16:33:14,512 - core.data_processor - INFO - Removing invalid records\n2025-08-21 16:33:14,518 - core.data_processor - INFO - Applying contact export-specific transformations\n2025-08-21 16:33:14,519 - core.data_processor - INFO - Contact export processing complete: 0 records\n2025-08-21 16:33:14,519 - __main__ - ERROR - Error in Contact Export workflow: 'First name'\nERROR: Error processing contact export data: 'First name'\nERROR: Contact workflow failed. Check logs for details.\n",
    "stderr": "--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n",
    "return_code": 1,
    "timestamp": "2025-08-21T16:33:14.666378",
    "analysis": {
      "chunk_file": "test_chunk_random_3_20250821_162727.xlsx",
      "pattern_type": "random",
      "success": false,
      "processing_time": 38.54762053489685,
      "issues_found": [
        "Workflow execution failed",
        "Unknown error occurred"
      ],
      "recommendations": [
        "Check input file path and permissions",
        "Verify Contact Export workflow configuration"
      ]
    }
  },
  {
    "chunk_file": "test_chunk_random_4_20250821_162727.xlsx",
    "pattern_type": "random",
    "output_file": "test_output_test_chunk_random_4_20250821_162727_20250821_163315.xlsx",
    "processing_time": 39.23170518875122,
    "success": false,
    "stdout": "2025-08-21 16:33:16,277 - __main__ - INFO - Starting Contact Export workflow processing: tests\\test_datasets\\test_chunk_random_4_20250821_162727.xlsx\n2025-08-21 16:33:16,475 - __main__ - INFO - Loaded 100 records for processing\nProcessing Contact Export using unified core logic...\n2025-08-21 16:33:16,476 - core.data_processor - INFO - Processing contact export data: 100 records\n2025-08-21 16:33:16,476 - core.data_processor - INFO - Applying unified cleaning logic\n2025-08-21 16:33:16,476 - core.data_processor - WARNING - Missing required column: contact_name, added as null\n2025-08-21 16:33:16,477 - core.data_processor - WARNING - Missing required column: customer_name, added as null\n2025-08-21 16:33:16,477 - core.data_processor - WARNING - Missing required column: email, added as null\n2025-08-21 16:33:16,477 - core.data_processor - INFO - Cleaning and parsing names using unified LLM engine\n2025-08-21 16:33:16,478 - core.data_processor - INFO - Processing name batch 1: records 1-50\n2025-08-21 16:33:17,143 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:17,569 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:17,890 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:18,259 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:18,606 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:18,919 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:19,234 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:19,569 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:19,903 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:20,256 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:20,596 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:20,963 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:21,312 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:21,661 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:22,003 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:22,365 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:22,698 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:23,074 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:23,437 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:23,774 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:24,171 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:24,514 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:24,880 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:25,264 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:25,611 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:25,997 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:26,410 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:26,825 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:27,214 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:27,613 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:27,970 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:28,417 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:28,874 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:29,211 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:29,651 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:30,052 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:30,439 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:30,799 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:31,204 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:31,568 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:31,909 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:32,309 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:32,809 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:33,309 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:33,782 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:34,280 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:34,667 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:35,067 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:35,511 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:35,929 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:36,342 - core.data_processor - INFO - Processing name batch 2: records 51-100\n2025-08-21 16:33:36,343 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:36,804 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:37,253 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:37,644 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:38,030 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:38,499 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:38,864 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:39,231 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:39,585 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:39,925 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:40,288 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:40,645 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:40,977 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:41,336 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:41,681 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:42,034 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:42,444 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:42,805 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:43,182 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:43,543 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:43,899 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:44,329 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:44,670 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:45,054 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:45,426 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:45,798 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:46,209 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:46,553 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:46,935 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:47,296 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:47,635 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:48,028 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:48,430 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:48,827 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:49,196 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:49,555 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:49,915 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:50,258 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:50,628 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:50,951 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:51,277 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:51,606 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:51,930 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:52,284 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:52,647 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:52,963 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:53,316 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:53,654 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:54,021 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:54,403 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:54,761 - core.data_processor - INFO - Cleaning email addresses\n2025-08-21 16:33:54,762 - core.data_processor - INFO - Removing invalid records\n2025-08-21 16:33:54,765 - core.data_processor - INFO - Applying contact export-specific transformations\n2025-08-21 16:33:54,765 - core.data_processor - INFO - Contact export processing complete: 0 records\n2025-08-21 16:33:54,766 - __main__ - ERROR - Error in Contact Export workflow: 'First name'\nERROR: Error processing contact export data: 'First name'\nERROR: Contact workflow failed. Check logs for details.\n",
    "stderr": "--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n",
    "return_code": 1,
    "timestamp": "2025-08-21T16:33:54.898683",
    "analysis": {
      "chunk_file": "test_chunk_random_4_20250821_162727.xlsx",
      "pattern_type": "random",
      "success": false,
      "processing_time": 39.23170518875122,
      "issues_found": [
        "Workflow execution failed",
        "Unknown error occurred"
      ],
      "recommendations": [
        "Check input file path and permissions",
        "Verify Contact Export workflow configuration"
      ]
    }
  },
  {
    "chunk_file": "test_chunk_random_5_20250821_162728.xlsx",
    "pattern_type": "random",
    "output_file": "test_output_test_chunk_random_5_20250821_162728_20250821_163355.xlsx",
    "processing_time": 39.42212748527527,
    "success": false,
    "stdout": "2025-08-21 16:33:56,474 - __main__ - INFO - Starting Contact Export workflow processing: tests\\test_datasets\\test_chunk_random_5_20250821_162728.xlsx\n2025-08-21 16:33:56,661 - __main__ - INFO - Loaded 100 records for processing\nProcessing Contact Export using unified core logic...\n2025-08-21 16:33:56,661 - core.data_processor - INFO - Processing contact export data: 100 records\n2025-08-21 16:33:56,661 - core.data_processor - INFO - Applying unified cleaning logic\n2025-08-21 16:33:56,662 - core.data_processor - WARNING - Missing required column: contact_name, added as null\n2025-08-21 16:33:56,662 - core.data_processor - WARNING - Missing required column: customer_name, added as null\n2025-08-21 16:33:56,662 - core.data_processor - WARNING - Missing required column: email, added as null\n2025-08-21 16:33:56,662 - core.data_processor - INFO - Cleaning and parsing names using unified LLM engine\n2025-08-21 16:33:56,663 - core.data_processor - INFO - Processing name batch 1: records 1-50\n2025-08-21 16:33:57,271 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:57,753 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:58,069 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:58,431 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:58,805 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:59,164 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:59,533 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:33:59,892 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:00,286 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:00,670 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:01,005 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:01,373 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:01,733 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:02,106 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:02,493 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:02,849 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:03,231 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:03,543 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:03,863 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:04,399 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:04,843 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:05,250 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:05,774 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:06,196 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:06,603 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:07,061 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:07,543 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:08,016 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:08,444 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:09,032 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:09,466 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:09,899 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:10,331 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:10,760 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:11,181 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:11,613 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:12,041 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:12,425 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:12,801 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:13,164 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:13,499 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:13,845 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:14,256 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:14,601 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:14,954 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:15,311 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:15,651 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:16,011 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:16,365 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:16,686 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:17,082 - core.data_processor - INFO - Processing name batch 2: records 51-100\n2025-08-21 16:34:17,082 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:17,428 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:17,780 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:18,120 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:18,466 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:18,812 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:19,185 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:19,551 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:19,912 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:20,283 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:20,638 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:21,000 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:21,371 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:21,706 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:22,050 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:22,414 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:22,760 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:23,138 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:23,510 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:23,861 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:24,285 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:24,650 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:25,018 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:25,396 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:25,761 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:26,121 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:26,479 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:26,828 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:27,190 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:27,573 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:27,923 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:28,298 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:28,651 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:29,027 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:29,422 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:29,779 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:30,146 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:30,512 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:30,871 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:31,226 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:31,568 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:31,922 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:32,279 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:32,644 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:33,009 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:33,368 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:33,731 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:34,107 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:34,460 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:34,816 - core.llm_engine - ERROR - OpenAI processing failed: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable\n2025-08-21 16:34:35,185 - core.data_processor - INFO - Cleaning email addresses\n2025-08-21 16:34:35,187 - core.data_processor - INFO - Removing invalid records\n2025-08-21 16:34:35,191 - core.data_processor - INFO - Applying contact export-specific transformations\n2025-08-21 16:34:35,192 - core.data_processor - INFO - Contact export processing complete: 0 records\n2025-08-21 16:34:35,192 - __main__ - ERROR - Error in Contact Export workflow: 'First name'\nERROR: Error processing contact export data: 'First name'\nERROR: Contact workflow failed. Check logs for details.\n",
    "stderr": "--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n--- Logging error ---\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python310\\lib\\logging\\__init__.py\", line 1103, in emit\n    stream.write(msg + self.terminator)\n  File \"C:\\Program Files\\Python310\\lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u2192' in position 88: character maps to <undefined>\nCall stack:\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 257, in <module>\n    main()\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 246, in main\n    success = process_contact_export_workflow(config, args.input_file, args.output_dir, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\main.py\", line 118, in process_contact_export_workflow\n    processed_data = processor.process_contact_export(data, date_range)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\workflows\\contact_export\\export_processor.py\", line 66, in process_contact_export\n    processed_data = self.data_processor.process_contact_export_data(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 87, in process_contact_export_data\n    processed_data = self._apply_unified_cleaning(data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 124, in _apply_unified_cleaning\n    cleaned_data = self._remove_invalid_records(cleaned_data)\n  File \"C:\\LocalAI\\!projects\\Stuart\\data_cleaner\\core\\data_processor.py\", line 311, in _remove_invalid_records\n    logger.info(f\"Removed {removed_count} invalid records: {initial_count} \\u2192 {final_count}\")\nMessage: 'Removed 100 invalid records: 100 \\u2192 0'\nArguments: ()\n",
    "return_code": 1,
    "timestamp": "2025-08-21T16:34:35.330016",
    "analysis": {
      "chunk_file": "test_chunk_random_5_20250821_162728.xlsx",
      "pattern_type": "random",
      "success": false,
      "processing_time": 39.42212748527527,
      "issues_found": [
        "Workflow execution failed",
        "Unknown error occurred"
      ],
      "recommendations": [
        "Check input file path and permissions",
        "Verify Contact Export workflow configuration"
      ]
    }
  }
]